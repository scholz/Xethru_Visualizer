# -*- coding: utf-8 -*-
"""
@created on: 2019-07-01
@author: Markus Scholz
@license: MIT
"""

import numpy as np

def colmap_spectrum_2(vmin=0., vmax=1.):
    from matplotlib.colors import ListedColormap, Normalize
    import matplotlib.cm as cm
    cmap_mpl = ListedColormap(spectrum_color_map())
    norm = Normalize(vmin=vmin, vmax=vmax)
    m = cm.ScalarMappable(norm=norm, cmap=cmap_mpl)
    lut = [np.array(m.to_rgba(x, bytes=True)) for x in np.linspace(0.,1.0,256)]
    lut = np.array(lut)
    #lut = cmap.getLookupTable(0.0, 1.0, 256)
    return lut

# colormaps from https://groups.google.com/forum/#!topic/pyqtgraph/gEjC08Vb8NQ
def cubehelix(gamma=1.0, s=0.5, r=-1.5, h=1.0):
    def get_color_function(p0, p1):
        def color(x):
            xg = x ** gamma
            a = h * xg * (1 - xg) / 2
            phi = 2 * np.pi * (s / 3 + r * x)
            return xg + a * (p0 * np.cos(phi) + p1 * np.sin(phi))
        return color

    array = np.empty((256, 3))
    abytes = np.arange(0, 1, 1/256.)
    array[:, 0] = get_color_function(-0.14861, 1.78277)(abytes) * 255
    array[:, 1] = get_color_function(-0.29227, -0.90649)(abytes) * 255
    array[:, 2] = get_color_function(1.97294, 0.0)(abytes) * 255
    return array

def rainbow():
    array = np.empty((256, 3))
    abytes = np.arange(0, 1, 0.00390625)
    array[:, 0] = np.abs(2 * abytes - 0.5) * 255
    array[:, 1] = np.sin(abytes * np.pi) * 255
    array[:, 2] = np.cos(abytes * np.pi / 2) * 255
    return array



def spectrum_color_map():
    return [(0.8, 0.8, 0.8),
     (0.8, 0.7372549019607844, 0.7372549019607844),
     (0.8, 0.6745098039215688, 0.6745098039215688),
     (0.8, 0.6117647058823531, 0.6117647058823531),
     (0.8, 0.5490196078431375, 0.5490196078431375),
     (0.8, 0.48627450980392184, 0.48627450980392184),
     (0.8, 0.4235294117647062, 0.4235294117647062),
     (0.8, 0.36078431372549064, 0.36078431372549064),
     (0.8, 0.298039215686275, 0.298039215686275),
     (0.8, 0.23529411764705932, 0.23529411764705932),
     (0.8, 0.17254901960784363, 0.17254901960784363),
     (0.8, 0.10980392156862806, 0.10980392156862806),
     (0.8, 0.047058823529412375, 0.047058823529412375),
     (0.8013078431372549, 0.0, 0.0),
     (0.8065392156862745, 0.0, 0.0),
     (0.8117705882352941, 0.0, 0.0),
     (0.8170019607843138, 0.0, 0.0),
     (0.8222333333333334, 0.0, 0.0),
     (0.827464705882353, 0.0, 0.0),
     (0.8326960784313726, 0.0, 0.0),
     (0.8379274509803922, 0.0, 0.0),
     (0.8431588235294118, 0.0, 0.0),
     (0.8483901960784315, 0.0, 0.0),
     (0.853621568627451, 0.0, 0.0),
     (0.8588529411764706, 0.0, 0.0),
     (0.8640843137254902, 0.0, 0.0),
     (0.8719274509803923, 0.0, 0.0),
     (0.8823823529411765, 0.0, 0.0),
     (0.8928372549019609, 0.0, 0.0),
     (0.9032921568627451, 0.0, 0.0),
     (0.9137470588235295, 0.0, 0.0),
     (0.9242019607843137, 0.0, 0.0),
     (0.9346568627450981, 0.0, 0.0),
     (0.9451117647058823, 0.0, 0.0),
     (0.9555666666666667, 0.0, 0.0),
     (0.9660215686274509, 0.0, 0.0),
     (0.9764764705882353, 0.0, 0.0),
     (0.9869313725490195, 0.0, 0.0),
     (0.9973862745098039, 0.0, 0.0),
     (1.0, 0.035294117647058545, 0.0),
     (1.0, 0.08235294117647039, 0.0),
     (1.0, 0.1294117647058819, 0.0),
     (1.0, 0.17647058823529407, 0.0),
     (1.0, 0.22352941176470592, 0.0),
     (1.0, 0.27058823529411774, 0.0),
     (1.0, 0.3176470588235293, 0.0),
     (1.0, 0.3647058823529415, 0.0),
     (1.0, 0.41176470588235325, 0.0),
     (1.0, 0.45882352941176513, 0.0),
     (1.0, 0.5058823529411767, 0.0),
     (1.0, 0.5529411764705888, 0.0),
     (1.0, 0.6000000000000002, 0.0),
     (1.0, 0.6156862745098041, 0.0),
     (1.0, 0.6313725490196079, 0.0),
     (1.0, 0.6470588235294119, 0.0),
     (1.0, 0.6627450980392159, 0.0),
     (1.0, 0.6784313725490198, 0.0),
     (1.0, 0.6941176470588235, 0.0),
     (1.0, 0.7098039215686276, 0.0),
     (1.0, 0.7254901960784315, 0.0),
     (1.0, 0.7411764705882353, 0.0),
     (1.0, 0.7568627450980392, 0.0),
     (1.0, 0.7725490196078432, 0.0),
     (1.0, 0.7882352941176471, 0.0),
     (0.9986921568627452, 0.8026137254901962, 0.0),
     (0.9934607843137255, 0.8130686274509804, 0.0),
     (0.988229411764706, 0.8235235294117645, 0.0),
     (0.9829980392156863, 0.833978431372549, 0.0),
     (0.9777666666666667, 0.8444333333333334, 0.0),
     (0.972535294117647, 0.8548882352941176, 0.0),
     (0.9673039215686275, 0.8653431372549019, 0.0),
     (0.9620725490196079, 0.8757980392156862, 0.0),
     (0.9568411764705883, 0.8862529411764706, 0.0),
     (0.9516098039215687, 0.8967078431372548, 0.0),
     (0.9463784313725492, 0.907162745098039, 0.0),
     (0.9411470588235294, 0.9176176470588234, 0.0),
     (0.9359156862745099, 0.9280725490196078, 0.0),
     (0.9254568627450983, 0.9359156862745097, 0.0),
     (0.9097705882352943, 0.9411470588235293, 0.0),
     (0.8940843137254904, 0.946378431372549, 0.0),
     (0.8783980392156865, 0.9516098039215686, 0.0),
     (0.8627117647058825, 0.9568411764705882, 0.0),
     (0.8470254901960788, 0.9620725490196077, 0.0),
     (0.8313392156862747, 0.9673039215686274, 0.0),
     (0.8156529411764707, 0.972535294117647, 0.0),
     (0.7999666666666667, 0.9777666666666667, 0.0),
     (0.7842803921568627, 0.9829980392156863, 0.0),
     (0.7685941176470588, 0.9882294117647059, 0.0),
     (0.7529078431372549, 0.9934607843137255, 0.0),
     (0.7372215686274509, 0.9986921568627452, 0.0),
     (0.6901647058823537, 1.0, 0.0),
     (0.6326509803921568, 1.0, 0.0),
     (0.5751372549019608, 1.0, 0.0),
     (0.5176235294117647, 1.0, 0.0),
     (0.4601098039215686, 1.0, 0.0),
     (0.4025960784313725, 1.0, 0.0),
     (0.34508235294117645, 1.0, 0.0),
     (0.2875686274509804, 1.0, 0.0),
     (0.23005490196078515, 1.0, 0.0),
     (0.1725411764705883, 1.0, 0.0),
     (0.11502745098039213, 1.0, 0.0),
     (0.057513725490196066, 1.0, 0.0),
     (0.0, 1.0, 0.0),
     (0.0, 0.9895450980392156, 0.0),
     (0.0, 0.9790901960784314, 0.0),
     (0.0, 0.968635294117647, 0.0),
     (0.0, 0.9581803921568629, 0.0),
     (0.0, 0.9477254901960784, 0.0),
     (0.0, 0.9372705882352941, 0.0),
     (0.0, 0.9268156862745097, 0.0),
     (0.0, 0.9163607843137254, 0.0),
     (0.0, 0.9059058823529411, 0.0),
     (0.0, 0.8954509803921568, 0.0),
     (0.0, 0.8849960784313724, 0.0),
     (0.0, 0.8745411764705883, 0.0),
     (0.0, 0.8640843137254901, 0.0),
     (0.0, 0.8536215686274509, 0.0),
     (0.0, 0.8431588235294116, 0.0),
     (0.0, 0.8326960784313724, 0.0),
     (0.0, 0.8222333333333333, 0.0),
     (0.0, 0.811770588235294, 0.0),
     (0.0, 0.8013078431372548, 0.0),
     (0.0, 0.7908450980392158, 0.0),
     (0.0, 0.7803823529411764, 0.0),
     (0.0, 0.7699196078431372, 0.0),
     (0.0, 0.7594568627450979, 0.0),
     (0.0, 0.7489941176470588, 0.0),
     (0.0, 0.7385313725490196, 0.0),
     (0.0, 0.7280725490196078, 0.0),
     (0.0, 0.7176176470588235, 0.0),
     (0.0, 0.7071627450980392, 0.0),
     (0.0, 0.6967078431372549, 0.0),
     (0.0, 0.6862529411764708, 0.0),
     (0.0, 0.6757980392156863, 0.0),
     (0.0, 0.6653431372549019, 0.0),
     (0.0, 0.6548882352941177, 0.0),
     (0.0, 0.6444333333333333, 0.0),
     (0.0, 0.633978431372549, 0.0),
     (0.0, 0.6235235294117647, 0.0),
     (0.0, 0.6130686274509803, 0.0),
     (0.0, 0.6026137254901961, 0.0),
     (0.0, 0.6039235294117646, 0.031370588235294115),
     (0.0, 0.6091549019607843, 0.07319803921568628),
     (0.0, 0.6143862745098039, 0.11502549019607844),
     (0.0, 0.6196176470588235, 0.15685294117647058),
     (0.0, 0.6248490196078431, 0.19868039215686276),
     (0.0, 0.6300803921568627, 0.2405078431372549),
     (0.0, 0.6353117647058824, 0.2823352941176471),
     (0.0, 0.6405431372549018, 0.324162745098038),
     (0.0, 0.6457745098039216, 0.36599019607843136),
     (0.0, 0.6510058823529411, 0.4078176470588235),
     (0.0, 0.6562372549019607, 0.4496450980392157),
     (0.0, 0.6614686274509803, 0.4914725490196078),
     (0.0, 0.6667, 0.5333),
     (0.0, 0.6667, 0.5437627450980392),
     (0.0, 0.6667, 0.5542254901960785),
     (0.0, 0.6667, 0.5646882352941176),
     (0.0, 0.6667, 0.5751509803921568),
     (0.0, 0.6667, 0.5856137254901961),
     (0.0, 0.6667, 0.5960764705882353),
     (0.0, 0.6667, 0.6065392156862744),
     (0.0, 0.6667, 0.6170019607843137),
     (0.0, 0.6667, 0.6274647058823529),
     (0.0, 0.6667, 0.6379274509803922),
     (0.0, 0.6667, 0.6483901960784311),
     (0.0, 0.6667, 0.6588529411764705),
     (0.0, 0.6653921568627451, 0.6706215686274509),
     (0.0, 0.6601607843137255, 0.6863078431372549),
     (0.0, 0.6549294117647059, 0.7019941176470588),
     (0.0, 0.6496980392156863, 0.7176803921568627),
     (0.0, 0.6444666666666666, 0.7333666666666666),
     (0.0, 0.639235294117647, 0.7490529411764706),
     (0.0, 0.6340039215686274, 0.7647392156862745),
     (0.0, 0.6287725490196078, 0.7804254901960784),
     (0.0, 0.6235411764705882, 0.7961117647058824),
     (0.0, 0.6183098039215686, 0.8117980392156863),
     (0.0, 0.613078431372549, 0.8274843137254903),
     (0.0, 0.6078470588235294, 0.8431705882352941),
     (0.0, 0.6026156862745098, 0.8588568627450981),
     (0.0, 0.5947725490196079, 0.8667),
     (0.0, 0.5843176470588238, 0.8667),
     (0.0, 0.5738627450980393, 0.8667),
     (0.0, 0.5634078431372549, 0.8667),
     (0.0, 0.5529529411764705, 0.8667),
     (0.0, 0.5424980392156863, 0.8667),
     (0.0, 0.5320431372549019, 0.8667),
     (0.0, 0.5215882352941177, 0.8667),
     (0.0, 0.5111333333333333, 0.8667),
     (0.0, 0.500678431372549, 0.8667),
     (0.0, 0.4902235294117647, 0.8667),
     (0.0, 0.47976862745098037, 0.8667),
     (0.0, 0.4693137254901961, 0.8667),
     (0.0, 0.43924705882352943, 0.8667),
     (0.0, 0.402643137254902, 0.8667),
     (0.0, 0.3660392156862745, 0.8667),
     (0.0, 0.32943529411764705, 0.8667),
     (0.0, 0.29283137254902064, 0.8667),
     (0.0, 0.2562274509803921, 0.8667),
     (0.0, 0.21962352941176472, 0.8667),
     (0.0, 0.18301960784313726, 0.8667),
     (0.0, 0.1464156862745098, 0.8667),
     (0.0, 0.10981176470588239, 0.8667),
     (0.0, 0.07320784313725492, 0.8667),
     (0.0, 0.03660392156862746, 0.8667),
     (0.0, 0.0, 0.8667),
     (0.0, 0.0, 0.851013725490196),
     (0.0, 0.0, 0.8353274509803922),
     (0.0, 0.0, 0.8196411764705882),
     (0.0, 0.0, 0.8039549019607843),
     (0.0, 0.0, 0.7882686274509804),
     (0.0, 0.0, 0.7725823529411765),
     (0.0, 0.0, 0.7568960784313725),
     (0.0, 0.0, 0.7412098039215691),
     (0.0, 0.0, 0.7255235294117647),
     (0.0, 0.0, 0.7098372549019607),
     (0.0, 0.0, 0.6941509803921568),
     (0.0, 0.0, 0.678464705882353),
     (0.01045686274509804, 0.0, 0.6653921568627451),
     (0.052284313725490195, 0.0, 0.6601607843137255),
     (0.09411176470588235, 0.0, 0.6549294117647059),
     (0.1359392156862745, 0.0, 0.6496980392156863),
     (0.17776666666666666, 0.0, 0.6444666666666666),
     (0.2195941176470588, 0.0, 0.639235294117647),
     (0.261421568627451, 0.0, 0.6340039215686274),
     (0.3032490196078431, 0.0, 0.6287725490196078),
     (0.3450764705882353, 0.0, 0.6235411764705882),
     (0.38690392156862746, 0.0, 0.6183098039215686),
     (0.4287313725490196, 0.0, 0.613078431372549),
     (0.4705588235294106, 0.0, 0.6078470588235295),
     (0.5123862745098039, 0.0, 0.6026156862745098),
     (0.5306882352941177, 0.0, 0.5973843137254902),
     (0.525464705882353, 0.0, 0.5921529411764705),
     (0.5202411764705882, 0.0, 0.5869215686274509),
     (0.5150176470588235, 0.0, 0.5816901960784313),
     (0.5097941176470588, 0.0, 0.5764588235294118),
     (0.5045705882352941, 0.0, 0.5712274509803922),
     (0.4993470588235294, 0.0, 0.5659960784313726),
     (0.4941235294117647, 0.0, 0.5607647058823529),
     (0.4889, 0.0, 0.5555333333333333),
     (0.4836764705882353, 0.0, 0.5503019607843137),
     (0.4784529411764706, 0.0, 0.5450705882352941),
     (0.4732294117647059, 0.0, 0.5398392156862745),
     (0.46800588235294116, 0.0, 0.534607843137255),
     (0.43924705882352943, 0.0, 0.5019294117647058),
     (0.402643137254903, 0.0, 0.4601019607843149),
     (0.3660392156862745, 0.0, 0.41827450980392156),
     (0.32943529411764705, 0.0, 0.3764470588235294),
     (0.2928313725490196, 0.0, 0.33461960784313727),
     (0.2562274509803921, 0.0, 0.29279215686274507),
     (0.21962352941176472, 0.0, 0.2509647058823529),
     (0.18301960784313726, 0.0, 0.20913725490196083),
     (0.1464156862745098, 0.0, 0.16730980392156863),
     (0.10981176470588239, 0.0, 0.1254823529411765),
     (0.07320784313725492, 0.0, 0.08365490196078429),
     (0.03660392156862746, 0.0, 0.0418274509803922),
     (0.0, 0.0, 0.0)]

